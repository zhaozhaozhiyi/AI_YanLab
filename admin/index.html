<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>数据看板 - AI颜值管家后台管理系统</title>
  
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- Chart.js -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  
  <!-- 自定义样式 -->
  <link rel="stylesheet" href="./assets/css/base.css">
  
  <!-- Tailwind配置 -->
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: {
              400: '#FF6B9D',
              500: '#FF3B7B',
            }
          }
        }
      }
    }
  </script>
</head>
<body class="bg-gray-50">
  
  <div class="admin-layout">
    
    <!-- 侧边栏 -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="flex items-center space-x-2">
          <i class="fas fa-spa text-2xl"></i>
          <span class="text-lg font-bold">AI颜值管家</span>
        </div>
      </div>
      
      <nav class="sidebar-menu">
        <div class="sidebar-item active" onclick="Router.navigate('./index.html')">
          <i class="fas fa-chart-line"></i>
          <span>数据看板</span>
        </div>
        <div class="sidebar-item" onclick="Router.navigate('./pages/users/list.html')">
          <i class="fas fa-users"></i>
          <span>用户管理</span>
        </div>
        <div class="sidebar-item" onclick="Router.navigate('./pages/content/articles.html')">
          <i class="fas fa-file-alt"></i>
          <span>内容管理</span>
        </div>
        <div class="sidebar-item" onclick="Router.navigate('./pages/analytics/dashboard.html')">
          <i class="fas fa-chart-bar"></i>
          <span>数据分析</span>
        </div>
        <div class="sidebar-item" onclick="Router.navigate('./pages/knowledge/list.html')">
          <i class="fas fa-brain"></i>
          <span>知识库管理</span>
        </div>
        <div class="sidebar-item" onclick="Router.navigate('./pages/system/roles.html')">
          <i class="fas fa-cog"></i>
          <span>系统设置</span>
        </div>
      </nav>
    </aside>

    <!-- 主内容区 -->
    <div class="main-content">
      
      <!-- 顶部栏 -->
      <header class="header">
        <div class="flex items-center space-x-4">
          <h1 class="text-xl font-bold text-gray-900">数据看板</h1>
        </div>
        <div class="flex items-center space-x-4">
          <div class="text-sm text-gray-600" id="currentUser">加载中...</div>
          <button onclick="handleLogout()" class="text-gray-600 hover:text-red-500">
            <i class="fas fa-sign-out-alt"></i>
            退出
          </button>
        </div>
      </header>

      <!-- 内容 -->
      <div class="content">
        
        <!-- 统计卡片 -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
          
          <!-- 总用户数 -->
          <div class="stats-card">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-gray-500 mb-1">总用户数</p>
                <p class="text-3xl font-bold text-gray-900" id="totalUsers">0</p>
                <p class="text-xs text-green-500 mt-2">
                  <i class="fas fa-arrow-up"></i> +12.5%
                </p>
              </div>
              <div class="stats-card-icon bg-blue-100 text-blue-500">
                <i class="fas fa-users"></i>
              </div>
            </div>
          </div>

          <!-- 评估次数 -->
          <div class="stats-card">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-gray-500 mb-1">评估次数</p>
                <p class="text-3xl font-bold text-gray-900">245</p>
                <p class="text-xs text-green-500 mt-2">
                  <i class="fas fa-arrow-up"></i> +8.3%
                </p>
              </div>
              <div class="stats-card-icon bg-purple-100 text-purple-500">
                <i class="fas fa-camera"></i>
              </div>
            </div>
          </div>

          <!-- 咨询次数 -->
          <div class="stats-card">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-gray-500 mb-1">咨询次数</p>
                <p class="text-3xl font-bold text-gray-900">189</p>
                <p class="text-xs text-green-500 mt-2">
                  <i class="fas fa-arrow-up"></i> +15.2%
                </p>
              </div>
              <div class="stats-card-icon bg-green-100 text-green-500">
                <i class="fas fa-comments"></i>
              </div>
            </div>
          </div>

          <!-- 预约次数 -->
          <div class="stats-card">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-gray-500 mb-1">预约次数</p>
                <p class="text-3xl font-bold text-gray-900">67</p>
                <p class="text-xs text-red-500 mt-2">
                  <i class="fas fa-arrow-down"></i> -2.1%
                </p>
              </div>
              <div class="stats-card-icon bg-yellow-100 text-yellow-500">
                <i class="fas fa-calendar-check"></i>
              </div>
            </div>
          </div>

        </div>

        <!-- 图表区域 -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
          
          <!-- 用户增长趋势 -->
          <div class="bg-white rounded-lg shadow p-6">
            <h3 class="text-lg font-bold text-gray-900 mb-4">用户增长趋势</h3>
            <canvas id="userChart" height="200"></canvas>
          </div>

          <!-- 业务数据统计 -->
          <div class="bg-white rounded-lg shadow p-6">
            <h3 class="text-lg font-bold text-gray-900 mb-4">业务数据统计</h3>
            <canvas id="businessChart" height="200"></canvas>
          </div>

        </div>

        <!-- 快捷入口 -->
        <div class="bg-white rounded-lg shadow p-6">
          <h3 class="text-lg font-bold text-gray-900 mb-4">快捷入口</h3>
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
            
            <div class="flex flex-col items-center justify-center p-4 border-2 border-dashed border-gray-200 rounded-lg hover:border-primary-400 hover:bg-primary-50 cursor-pointer transition-colors" onclick="Router.navigate('./pages/users/list.html')">
              <i class="fas fa-users text-3xl text-primary-400 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">用户管理</span>
            </div>

            <div class="flex flex-col items-center justify-center p-4 border-2 border-dashed border-gray-200 rounded-lg hover:border-primary-400 hover:bg-primary-50 cursor-pointer transition-colors" onclick="Router.navigate('./pages/content/articles.html')">
              <i class="fas fa-file-alt text-3xl text-purple-400 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">内容管理</span>
            </div>

            <div class="flex flex-col items-center justify-center p-4 border-2 border-dashed border-gray-200 rounded-lg hover:border-primary-400 hover:bg-primary-50 cursor-pointer transition-colors" onclick="Router.navigate('./pages/knowledge/list.html')">
              <i class="fas fa-brain text-3xl text-green-400 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">知识库</span>
            </div>

            <div class="flex flex-col items-center justify-center p-4 border-2 border-dashed border-gray-200 rounded-lg hover:border-primary-400 hover:bg-primary-50 cursor-pointer transition-colors" onclick="Router.navigate('./pages/analytics/funnel.html')">
              <i class="fas fa-chart-pie text-3xl text-yellow-400 mb-2"></i>
              <span class="text-sm font-medium text-gray-700">转化分析</span>
            </div>

          </div>
        </div>

      </div>

    </div>

  </div>

  <!-- 共享工具 -->
  <script src="../shared/storage.js"></script>
  <script src="../shared/utils.js"></script>
  <script src="../shared/router.js"></script>
  <script src="../shared/mock.js"></script>

  <!-- 页面脚本 -->
  <script>
    // 检查登录状态
    document.addEventListener('DOMContentLoaded', () => {
      const admin = Storage.get('currentAdmin');
      if (!admin) {
        Router.navigate('./login.html');
        return;
      }
      
      // 显示当前用户
      document.getElementById('currentUser').textContent = `${admin.name}（${admin.role === 'admin' ? '管理员' : admin.role}）`;
      
      // 加载统计数据
      loadStats();
      
      // 初始化图表
      initCharts();
    });

    // 加载统计数据
    function loadStats() {
      const users = Storage.get('users') || [];
      document.getElementById('totalUsers').textContent = users.length;
    }

    // 初始化图表
    function initCharts() {
      // 用户增长趋势图
      const userCtx = document.getElementById('userChart').getContext('2d');
      new Chart(userCtx, {
        type: 'line',
        data: {
          labels: ['1月', '2月', '3月', '4月', '5月', '6月'],
          datasets: [{
            label: '用户数',
            data: [120, 190, 300, 500, 820, 1200],
            borderColor: '#FF6B9D',
            backgroundColor: 'rgba(255, 107, 157, 0.1)',
            tension: 0.4,
            fill: true,
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: false
            }
          },
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });

      // 业务数据统计图
      const businessCtx = document.getElementById('businessChart').getContext('2d');
      new Chart(businessCtx, {
        type: 'bar',
        data: {
          labels: ['评估', '咨询', '预约', '转化'],
          datasets: [{
            label: '数量',
            data: [245, 189, 67, 45],
            backgroundColor: [
              'rgba(255, 107, 157, 0.8)',
              'rgba(107, 102, 255, 0.8)',
              'rgba(16, 185, 129, 0.8)',
              'rgba(245, 158, 11, 0.8)',
            ],
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: false
            }
          },
          scales: {
            y: {
              beginAtZero: true
            }
          }
        }
      });
    }

    // 退出登录
    function handleLogout() {
      Utils.showConfirm('确定要退出登录吗？', () => {
        Router.adminLogout();
      });
    }
  </script>

</body>
</html>

