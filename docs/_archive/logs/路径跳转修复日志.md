# 路径跳转修复日志

## 修复时间
2025年10月13日

## 问题描述
项目部署到不同环境（本地、GitHub Pages、Gitee Pages）后，跳转链接出现错误，主要问题：
1. 使用onclick+JavaScript跳转，依赖脚本加载
2. 混用绝对路径和相对路径
3. 部分路径计算错误
4. 用户体验差（无法右键打开、拖拽链接等）

## 修复方案
采用 **a标签 + 相对路径** 的统一方案，让浏览器原生处理路径计算。

## 修复内容

### 一、页面跳转链接修复

#### 1. web/pages/profile/index.html
**修复内容：**
- ✅ 顶部设置按钮：`button onclick` → `<a href="./edit.html">`
- ✅ 我的评估报告菜单：`div onclick` → `<a href="./reports.html">`
- ✅ 我的预约菜单：`div onclick` → `<a href="./appointments.html">`
- ✅ 我的收藏菜单：`div onclick` → `<a href="./favorites.html">`
- ✅ 个人资料菜单：`div onclick` → `<a href="./edit.html">`
- ✅ 设置菜单：`div onclick` → `<a href="./settings.html">`

#### 2. web/pages/assessment/report.html
**修复内容：**
- ✅ 返回首页按钮：`button onclick="Router.navigate('/web/index.html')"` → `<a href="../../index.html">`
- ✅ 开始真实评估按钮：`button onclick="Router.navigate('/web/pages/assessment/guide.html')"` → `<a href="./guide.html">`

#### 3. web/pages/assessment/index.html
**修复内容：**
- ✅ 查看全部历史记录：`<a href="javascript:void(0)" onclick="viewHistory()">` → `<a href="../profile/reports.html">`

#### 4. web/pages/profile/reports.html
**修复内容：**
- ✅ 空状态跳转：`button onclick="window.location.href='../assessment/guide.html'"` → `<a href="../assessment/guide.html">`

#### 5. web/pages/profile/favorites.html
**修复内容：**
- ✅ 空状态跳转：修复错误路径 `./pages/community/index.html` → `../community/index.html`
- ✅ 改为a标签：`button onclick` → `<a href="../community/index.html">`

#### 6. web/pages/profile/appointments.html
**修复内容：**
- ✅ 空状态跳转：修复错误路径 `./pages/booking/experts.html` → `../booking/index.html`
- ✅ 改为a标签：`button onclick` → `<a href="../booking/index.html">`

#### 7. web/pages/profile/settings.html
**修复内容：**
- ✅ 个人资料设置项：`div onclick="window.location.href='./edit.html'"` → `<a href="./edit.html">`

### 二、静态资源路径修复

#### CSS文件引用修复
将所有 `/web/assets/css/base.css` 改为相对路径 `../../assets/css/base.css`

**修复文件列表：**
- ✅ web/pages/profile/settings.html
- ✅ web/pages/profile/appointments.html
- ✅ web/pages/profile/favorites.html
- ✅ web/pages/profile/reports.html
- ✅ web/pages/profile/edit.html
- ✅ web/pages/assessment/waiting.html
- ✅ web/pages/assessment/camera.html
- ✅ web/pages/assessment/confirm.html
- ✅ web/pages/auth/login.html

#### JavaScript文件引用修复
将所有 `/shared/*.js` 改为相对路径 `../../../shared/*.js`

**修复文件列表：**
- ✅ web/pages/auth/login.html
- ✅ web/pages/profile/edit.html
- ✅ web/pages/profile/reports.html
- ✅ web/pages/profile/favorites.html
- ✅ web/pages/profile/appointments.html
- ✅ web/pages/profile/settings.html
- ✅ web/pages/profile/index.html

## 修复统计

### 修复数量
- **跳转链接修复：** 13处
- **CSS引用修复：** 9个文件
- **JavaScript引用修复：** 7个文件
- **路径错误修复：** 2处（favorites和appointments的错误路径）

### 涉及文件
共修复 **10个HTML文件**：
1. web/pages/profile/index.html
2. web/pages/profile/edit.html
3. web/pages/profile/reports.html
4. web/pages/profile/favorites.html
5. web/pages/profile/appointments.html
6. web/pages/profile/settings.html
7. web/pages/assessment/index.html
8. web/pages/assessment/report.html
9. web/pages/assessment/waiting.html
10. web/pages/assessment/camera.html
11. web/pages/assessment/confirm.html
12. web/pages/auth/login.html

## 相对路径对照表

### 从 web/pages/profile/ 到其他位置
```
当前位置: /web/pages/profile/*.html

→ 同级页面:        ./edit.html
→ 上级web目录:     ../../index.html
→ assessment目录:  ../assessment/guide.html
→ community目录:   ../community/index.html
→ shared目录:      ../../../shared/router.js
→ assets目录:      ../../assets/css/base.css
```

### 从 web/pages/assessment/ 到其他位置
```
当前位置: /web/pages/assessment/*.html

→ 同级页面:        ./guide.html
→ 上级web目录:     ../../index.html
→ profile目录:     ../profile/reports.html
→ shared目录:      ../../../shared/router.js
→ assets目录:      ../../assets/css/base.css
```

### 从 web/pages/auth/ 到其他位置
```
当前位置: /web/pages/auth/*.html

→ 上级web目录:     ../../index.html
→ shared目录:      ../../../shared/router.js
→ assets目录:      ../../assets/css/base.css
```

## 修复效果

### ✅ 优点
1. **环境兼容性强**：本地、GitHub Pages、Gitee Pages都能正常工作
2. **不依赖JavaScript**：即使脚本加载失败，链接仍能正常跳转
3. **用户体验好**：支持右键"新标签打开"、拖拽链接、悬停预览等
4. **SEO友好**：搜索引擎可以正常爬取链接
5. **代码简洁**：减少了JavaScript代码，提高了可维护性

### 🎯 兼容性
- ✅ 本地开发环境（localhost）
- ✅ GitHub Pages（子目录部署）
- ✅ Gitee Pages（子目录部署）
- ✅ 自定义域名部署

## 后续建议

### 1. 保留的onclick场景
以下场景仍保留onclick，因为需要执行额外逻辑：
- 退出登录（需要清除本地存储）
- 表单提交（需要验证）
- 弹窗提示（如"功能即将上线"）
- 条件跳转（需要检查登录状态）

### 2. 待完善功能
- `web/pages/booking/index.html` 需要创建（当前appointments页面跳转到此）
- 其他模块的跳转链接也建议采用相对路径

### 3. 开发规范
今后新增页面时，请遵循以下规范：
1. **优先使用a标签**：简单跳转用`<a href="相对路径">`
2. **使用相对路径**：避免使用绝对路径
3. **保持一致性**：同级用`./`，上级用`../`
4. **特殊场景**：需要逻辑判断时，可使用onclick配合a标签的href

## 参考文档
详细的路径跳转规范和使用指南，请参考：
- [路径跳转统一方案.md](./路径跳转统一方案.md)

## 测试清单
部署后请测试以下功能：
- [ ] 个人中心各菜单跳转
- [ ] 评估报告页面返回首页
- [ ] 评估历史查看全部
- [ ] 空状态页面的引导按钮
- [ ] 所有CSS样式加载正常
- [ ] 所有JavaScript功能正常

---

**修复人员：** AI Assistant  
**审核状态：** 待测试  
**备注：** 建议在本地、GitHub Pages和Gitee Pages三个环境分别测试

