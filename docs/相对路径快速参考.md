# 相对路径快速参考卡片 📌

## 🎯 核心原则
**使用 a标签 + 相对路径，不要用onclick跳转！**

---

## 📁 项目结构速览
```
/
├── web/
│   ├── index.html                    ← Web前台首页
│   ├── assets/                       ← 静态资源
│   │   └── css/base.css
│   └── pages/
│       ├── auth/                     ← 认证页面
│       │   └── login.html
│       ├── assessment/               ← 评估模块
│       │   ├── index.html
│       │   ├── guide.html
│       │   ├── camera.html
│       │   ├── confirm.html
│       │   ├── waiting.html
│       │   └── report.html
│       ├── profile/                  ← 个人中心
│       │   ├── index.html
│       │   ├── edit.html
│       │   ├── reports.html
│       │   ├── appointments.html
│       │   ├── favorites.html
│       │   └── settings.html
│       ├── community/
│       │   └── index.html
│       └── booking/
│           └── index.html
├── admin/                            ← 后台管理
│   └── index.html
└── shared/                           ← 共享脚本
    ├── router.js
    ├── utils.js
    └── storage.js
```

---

## 🗺️ 路径速查表

### 从 profile 目录跳转
**当前位置：** `/web/pages/profile/*.html`

| 目标 | 相对路径 | 示例 |
|------|---------|------|
| 同级页面 | `./xxx.html` | `<a href="./edit.html">编辑</a>` |
| Web首页 | `../../index.html` | `<a href="../../index.html">首页</a>` |
| 评估首页 | `../assessment/index.html` | `<a href="../assessment/index.html">评估</a>` |
| 评估引导 | `../assessment/guide.html` | `<a href="../assessment/guide.html">开始评估</a>` |
| 评估报告 | `../assessment/report.html` | `<a href="../assessment/report.html">报告</a>` |
| 社区首页 | `../community/index.html` | `<a href="../community/index.html">社区</a>` |
| 预约页面 | `../booking/index.html` | `<a href="../booking/index.html">预约</a>` |
| 登录页面 | `../auth/login.html` | `<a href="../auth/login.html">登录</a>` |
| CSS样式 | `../../assets/css/base.css` | `<link href="../../assets/css/base.css">` |
| JS脚本 | `../../../shared/router.js` | `<script src="../../../shared/router.js">` |

### 从 assessment 目录跳转
**当前位置：** `/web/pages/assessment/*.html`

| 目标 | 相对路径 | 示例 |
|------|---------|------|
| 同级页面 | `./xxx.html` | `<a href="./camera.html">拍照</a>` |
| Web首页 | `../../index.html` | `<a href="../../index.html">首页</a>` |
| 个人中心 | `../profile/index.html` | `<a href="../profile/index.html">我的</a>` |
| 我的报告 | `../profile/reports.html` | `<a href="../profile/reports.html">查看全部</a>` |
| 登录页面 | `../auth/login.html` | `<a href="../auth/login.html">登录</a>` |
| CSS样式 | `../../assets/css/base.css` | `<link href="../../assets/css/base.css">` |
| JS脚本 | `../../../shared/router.js` | `<script src="../../../shared/router.js">` |

### 从 auth 目录跳转
**当前位置：** `/web/pages/auth/*.html`

| 目标 | 相对路径 | 示例 |
|------|---------|------|
| Web首页 | `../../index.html` | `<a href="../../index.html">首页</a>` |
| 个人中心 | `../profile/index.html` | `<a href="../profile/index.html">我的</a>` |
| 评估首页 | `../assessment/index.html` | `<a href="../assessment/index.html">评估</a>` |
| CSS样式 | `../../assets/css/base.css` | `<link href="../../assets/css/base.css">` |
| JS脚本 | `../../../shared/router.js` | `<script src="../../../shared/router.js">` |

---

## ✅ 正确写法示例

### 1. 导航链接
```html
<!-- ✅ 推荐：a标签 + 相对路径 -->
<a href="./edit.html">编辑资料</a>
<a href="../assessment/guide.html">开始评估</a>
<a href="../../index.html">返回首页</a>

<!-- ❌ 错误：onclick跳转 -->
<div onclick="window.location.href='./edit.html'">编辑资料</div>
<button onclick="Router.navigate('/web/index.html')">返回首页</button>
```

### 2. 菜单项
```html
<!-- ✅ 推荐：a标签作为菜单容器 -->
<a href="./reports.html" class="menu-item">
  <div class="menu-icon">
    <i class="fas fa-file"></i>
  </div>
  <div class="flex-1">
    <h4>我的报告</h4>
    <p>查看历史记录</p>
  </div>
  <i class="fas fa-chevron-right"></i>
</a>

<!-- ❌ 错误：div + onclick -->
<div class="menu-item" onclick="window.location.href='./reports.html'">
  ...
</div>
```

### 3. 按钮跳转
```html
<!-- ✅ 推荐：a标签样式化为按钮 -->
<a href="../assessment/guide.html" 
   class="px-8 py-3 bg-gradient-to-r from-pink-500 to-purple-600 text-white rounded-full">
  立即开始评估
</a>

<!-- ❌ 错误：button + onclick -->
<button onclick="window.location.href='../assessment/guide.html'">
  立即开始评估
</button>
```

### 4. 带参数的跳转
```html
<!-- ✅ 推荐：URL参数直接写在href -->
<a href="./report.html?id=123&type=basic">查看报告</a>

<!-- 如果需要动态生成参数 -->
<a href="#" onclick="goToReport(123); return false;">查看报告</a>
<script>
function goToReport(id) {
  window.location.href = `./report.html?id=${id}`;
}
</script>
```

---

## 🚫 需要onclick的特殊场景

以下场景仍需要使用onclick（需要执行额外逻辑）：

### 1. 退出登录
```html
<a href="#" onclick="handleLogout(); return false;">退出登录</a>

<script>
function handleLogout() {
  Storage.remove('currentUser');
  window.location.href = '../../index.html';
}
</script>
```

### 2. 条件跳转
```html
<a href="../assessment/guide.html" onclick="return checkLogin()">开始评估</a>

<script>
function checkLogin() {
  if (!Storage.get('currentUser')) {
    window.location.href = '../auth/login.html';
    return false; // 阻止默认跳转
  }
  return true; // 允许跳转
}
</script>
```

### 3. 确认对话框
```html
<a href="#" onclick="return confirmDelete()">删除</a>

<script>
function confirmDelete() {
  if (confirm('确定要删除吗？')) {
    // 执行删除逻辑
    return true;
  }
  return false;
}
</script>
```

---

## 🔄 Router.navigate() 使用场景

项目保留了 `shared/router.js` 用于特定场景。虽然**优先使用 a标签**，但以下场景可以使用 Router 对象：

### 1. 登录状态检查 + 跳转
```javascript
// 检查登录后跳转
function startAssessment() {
  if (!Router.checkLogin()) {
    // Router.checkLogin() 会自动跳转到登录页
    return;
  }
  window.location.href = '../assessment/guide.html';
}
```

### 2. 动态参数构建
```javascript
// 文章详情跳转（ID来自后端）
function goToArticle(articleId) {
  Router.navigate('/web/pages/community/article.html', { id: articleId });
}

// 等价于
function goToArticle(articleId) {
  window.location.href = `./article.html?id=${articleId}`;
}
```

### 3. 获取URL参数
```javascript
// 读取URL参数
const articleId = Router.getQuery('id');
const type = Router.getQuery('type');

// 获取所有参数
const params = Router.getAllQuery(); // {id: '123', type: 'basic'}
```

### 4. 退出登录
```javascript
// Router 提供的便捷方法
function logout() {
  Router.logout(); // 自动清除用户数据并跳转到首页
}

// 等价于
function logout() {
  Storage.remove('currentUser');
  window.location.href = '../../index.html';
}
```

### 5. 环境检测
```javascript
// 检查部署环境
const env = Router.getEnvironmentInfo();
console.log(env.isGitHubPages); // true/false
console.log(env.basePath);      // '/AI_YanLab' 或 ''
```

### ⚠️ 注意事项

1. **优先使用 a标签**：普通页面跳转请使用 `<a href="...">`
2. **Router 是工具类**：仅在需要额外逻辑时使用
3. **相对路径更简单**：对于静态跳转，相对路径更直观
4. **SEO友好**：搜索引擎更喜欢 a标签

### 📋 决策流程图
```
需要页面跳转？
├─ 是否需要登录检查？
│  ├─ 是 → 使用 Router.checkLogin() + 相对路径
│  └─ 否 ↓
├─ 是否有动态参数？
│  ├─ 是 → 使用 JS + 相对路径（或 Router.navigate）
│  └─ 否 ↓
├─ 是否需要条件判断？
│  ├─ 是 → 使用 onclick + 相对路径
│  └─ 否 ↓
└─ 直接使用 <a href="相对路径">
```

---

## 🧮 相对路径计算方法

### 规则
- `./` = 当前目录
- `../` = 上一级目录
- `../../` = 上两级目录

### 计算步骤
1. **确定当前页面位置**：数一下从项目根目录到当前页面有几层
2. **确定目标页面位置**：数一下从项目根目录到目标页面有几层
3. **计算相对路径**：
   - 先用`../`返回到共同的父目录
   - 再写出目标页面的路径

### 示例
```
当前页面：/web/pages/profile/index.html (3层)
目标页面：/web/pages/assessment/guide.html (3层)

步骤：
1. 从 profile/ 返回到 pages/：../
2. 进入 assessment/：assessment/
3. 目标文件：guide.html

结果：../assessment/guide.html
```

```
当前页面：/web/pages/profile/index.html (3层)
目标页面：/web/index.html (1层)

步骤：
1. 从 profile/ 返回到 pages/：../
2. 从 pages/ 返回到 web/：../
3. 目标文件：index.html

结果：../../index.html
```

---

## 💡 实用技巧

### 1. VS Code 自动补全
输入`./`或`../`时，VS Code会自动提示可用文件

### 2. Chrome开发者工具验证
按F12打开控制台，检查是否有404错误

### 3. 测试右键菜单
右键点击链接，如果能看到"在新标签中打开"，说明链接正确

### 4. 本地测试
使用Live Server或简单的HTTP服务器测试，不要直接双击HTML文件

---

## 📚 相关文档
- [shared/router.js](../shared/router.js) - Router工具类源码
- [路径兼容性方案说明（已废弃）](./_archive/路径兼容性方案说明-已废弃.md) - 历史技术方案
- [路径跳转修复日志](./_archive/logs/路径跳转修复日志.md) - 修复记录

---

## 🆘 常见问题

**Q: 为什么不用绝对路径？**  
A: 绝对路径在子目录部署（如GitHub Pages）时会404

**Q: 为什么不用onclick？**  
A: onclick依赖JS，无法右键打开，SEO不友好

**Q: shared目录的脚本怎么引用？**  
A: 从`web/pages/xxx/`到`shared/`需要`../../../shared/`

**Q: CSS和JS引用也要用相对路径吗？**  
A: 是的，所有资源都应该用相对路径

**Q: 如何快速检查路径是否正确？**  
A: 浏览器打开页面，看控制台有没有404错误

---

📖 **打印此页面，贴在显示器旁边，随时查阅！**

