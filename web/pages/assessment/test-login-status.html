<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç™»å½•çŠ¶æ€æµ‹è¯•å·¥å…·</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <style>
    body {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 2rem;
    }

    .card {
      background: white;
      border-radius: 20px;
      padding: 2rem;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      max-width: 600px;
      width: 100%;
    }

    .status-badge {
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 1rem;
      border-radius: 50px;
      font-weight: 600;
      font-size: 0.875rem;
    }

    .status-logged-in {
      background: #dcfce7;
      color: #166534;
    }

    .status-logged-out {
      background: #fee2e2;
      color: #991b1b;
    }

    .status-guest {
      background: #fef3c7;
      color: #92400e;
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border-radius: 10px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      justify-content: center;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
    }

    .btn-success {
      background: #10b981;
      color: white;
    }

    .btn-success:hover {
      background: #059669;
      transform: translateY(-2px);
    }

    .btn-danger {
      background: #ef4444;
      color: white;
    }

    .btn-danger:hover {
      background: #dc2626;
      transform: translateY(-2px);
    }

    .btn-warning {
      background: #f59e0b;
      color: white;
    }

    .btn-warning:hover {
      background: #d97706;
      transform: translateY(-2px);
    }

    .info-box {
      background: #f3f4f6;
      border-left: 4px solid #667eea;
      padding: 1rem;
      border-radius: 8px;
      margin: 1rem 0;
    }

    .log-container {
      background: #1e293b;
      color: #e2e8f0;
      padding: 1rem;
      border-radius: 8px;
      font-family: 'Courier New', monospace;
      font-size: 0.875rem;
      max-height: 200px;
      overflow-y: auto;
      margin-top: 1rem;
    }

    .log-entry {
      margin: 0.25rem 0;
      padding: 0.25rem;
      border-radius: 4px;
    }

    .log-success {
      color: #4ade80;
    }

    .log-error {
      color: #f87171;
    }

    .log-info {
      color: #60a5fa;
    }
  </style>
</head>
<body>
  <div class="card">
    <div class="text-center mb-6">
      <h1 class="text-3xl font-bold text-gray-800 mb-2">
        <i class="fas fa-vial text-purple-600"></i>
        ç™»å½•çŠ¶æ€æµ‹è¯•å·¥å…·
      </h1>
      <p class="text-gray-600">å¿«é€Ÿåˆ‡æ¢ç™»å½•çŠ¶æ€ï¼Œæµ‹è¯•æ‹ç…§å¼•å¯¼é¡µ</p>
    </div>

    <!-- å½“å‰çŠ¶æ€ -->
    <div class="mb-6">
      <h2 class="text-lg font-semibold text-gray-700 mb-3">å½“å‰çŠ¶æ€ï¼š</h2>
      <div id="currentStatus" class="flex flex-wrap gap-2">
        <span class="status-badge status-logged-out">
          <i class="fas fa-user-slash"></i>
          æœªç™»å½•
        </span>
      </div>
      <div id="userInfo" class="info-box hidden">
        <strong>ç”¨æˆ·ä¿¡æ¯ï¼š</strong>
        <pre id="userInfoContent" class="mt-2 text-sm"></pre>
      </div>
    </div>

    <!-- æ“ä½œæŒ‰é’® -->
    <div class="space-y-3 mb-6">
      <h2 class="text-lg font-semibold text-gray-700 mb-3">å¿«é€Ÿæ“ä½œï¼š</h2>
      
      <button onclick="simulateLogin()" class="btn btn-success w-full">
        <i class="fas fa-sign-in-alt"></i>
        æ¨¡æ‹Ÿç™»å½•ï¼ˆæµ‹è¯•ç”¨æˆ·ï¼‰
      </button>

      <button onclick="simulateGuest()" class="btn btn-warning w-full">
        <i class="fas fa-user-secret"></i>
        è®¾ç½®ä¸ºæ¸¸å®¢æ¨¡å¼
      </button>

      <button onclick="clearAll()" class="btn btn-danger w-full">
        <i class="fas fa-trash"></i>
        æ¸…é™¤æ‰€æœ‰çŠ¶æ€
      </button>

      <div class="grid grid-cols-2 gap-3">
        <button onclick="viewStorage()" class="btn btn-primary">
          <i class="fas fa-database"></i>
          æŸ¥çœ‹å­˜å‚¨
        </button>
        <button onclick="goToGuide()" class="btn btn-primary">
          <i class="fas fa-arrow-right"></i>
          å‰å¾€å¼•å¯¼é¡µ
        </button>
      </div>
    </div>

    <!-- é¢„è®¾ç”¨æˆ· -->
    <div class="mb-6">
      <h2 class="text-lg font-semibold text-gray-700 mb-3">é¢„è®¾ç”¨æˆ·ï¼š</h2>
      <div class="grid grid-cols-2 gap-2">
        <button onclick="loginAs('user1')" class="btn" style="background: #fce7f3; color: #831843;">
          <i class="fas fa-user"></i>
          å°çº¢
        </button>
        <button onclick="loginAs('user2')" class="btn" style="background: #dbeafe; color: #1e3a8a;">
          <i class="fas fa-user"></i>
          å°æ˜
        </button>
        <button onclick="loginAs('user3')" class="btn" style="background: #fef3c7; color: #78350f;">
          <i class="fas fa-user"></i>
          å°èŠ³
        </button>
        <button onclick="loginAs('vip')" class="btn" style="background: #fef9c3; color: #713f12;">
          <i class="fas fa-crown"></i>
          VIPç”¨æˆ·
        </button>
      </div>
    </div>

    <!-- æ—¥å¿— -->
    <div>
      <h2 class="text-lg font-semibold text-gray-700 mb-2">æ“ä½œæ—¥å¿—ï¼š</h2>
      <div id="logContainer" class="log-container">
        <div class="log-entry log-info">å‡†å¤‡å°±ç»ªï¼Œç­‰å¾…æ“ä½œ...</div>
      </div>
    </div>
  </div>

  <!-- å¼•å…¥å…±äº«è„šæœ¬ -->
  <script src="/shared/storage.js"></script>
  <script src="/shared/router.js"></script>

  <script>
    // é¢„è®¾ç”¨æˆ·æ•°æ®
    const presetUsers = {
      user1: {
        id: 'user_001',
        phone: '13800138001',
        nickname: 'å°çº¢',
        avatar: '/web/assets/images/avatars/avatar1.jpg',
        gender: 'female',
        age: 25
      },
      user2: {
        id: 'user_002',
        phone: '13800138002',
        nickname: 'å°æ˜',
        avatar: '/web/assets/images/avatars/avatar2.jpg',
        gender: 'male',
        age: 28
      },
      user3: {
        id: 'user_003',
        phone: '13800138003',
        nickname: 'å°èŠ³',
        avatar: '/web/assets/images/avatars/avatar3.jpg',
        gender: 'female',
        age: 23
      },
      vip: {
        id: 'vip_001',
        phone: '13900139000',
        nickname: 'VIPç”¨æˆ·',
        avatar: '/web/assets/images/avatars/avatar4.jpg',
        vipLevel: 3,
        vipExpire: Date.now() + 365 * 24 * 60 * 60 * 1000
      }
    };

    // æ—¥å¿—å‡½æ•°
    function addLog(message, type = 'info') {
      const logContainer = document.getElementById('logContainer');
      const time = new Date().toLocaleTimeString();
      const logEntry = document.createElement('div');
      logEntry.className = `log-entry log-${type}`;
      logEntry.textContent = `[${time}] ${message}`;
      logContainer.appendChild(logEntry);
      logContainer.scrollTop = logContainer.scrollHeight;
    }

    // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
    function updateStatus() {
      const currentUser = Storage.get('currentUser');
      const isGuest = Storage.get('guestMode');
      const statusDiv = document.getElementById('currentStatus');
      const userInfoDiv = document.getElementById('userInfo');
      const userInfoContent = document.getElementById('userInfoContent');
      
      let badges = [];
      
      if (currentUser) {
        badges.push(`
          <span class="status-badge status-logged-in">
            <i class="fas fa-check-circle"></i>
            å·²ç™»å½•ï¼š${currentUser.nickname || currentUser.phone}
          </span>
        `);
        userInfoContent.textContent = JSON.stringify(currentUser, null, 2);
        userInfoDiv.classList.remove('hidden');
      } else {
        badges.push(`
          <span class="status-badge status-logged-out">
            <i class="fas fa-user-slash"></i>
            æœªç™»å½•
          </span>
        `);
        userInfoDiv.classList.add('hidden');
      }
      
      if (isGuest) {
        badges.push(`
          <span class="status-badge status-guest">
            <i class="fas fa-user-secret"></i>
            æ¸¸å®¢æ¨¡å¼
          </span>
        `);
      }
      
      statusDiv.innerHTML = badges.join('');
    }

    // æ¨¡æ‹Ÿç™»å½•
    function simulateLogin() {
      const testUser = {
        id: 'test_' + Date.now(),
        phone: '13800138000',
        nickname: 'æµ‹è¯•ç”¨æˆ·',
        avatar: '/web/assets/images/avatars/avatar1.jpg',
        loginTime: Date.now()
      };
      
      Storage.set('currentUser', testUser);
      Storage.remove('guestMode');
      addLog('âœ… å·²è®¾ç½®æµ‹è¯•ç™»å½•çŠ¶æ€', 'success');
      updateStatus();
    }

    // ä½¿ç”¨é¢„è®¾ç”¨æˆ·ç™»å½•
    function loginAs(userId) {
      const user = presetUsers[userId];
      if (user) {
        user.loginTime = Date.now();
        Storage.set('currentUser', user);
        Storage.remove('guestMode');
        addLog(`âœ… å·²ç™»å½•ä¸ºï¼š${user.nickname}`, 'success');
        updateStatus();
      }
    }

    // è®¾ç½®æ¸¸å®¢æ¨¡å¼
    function simulateGuest() {
      Storage.remove('currentUser');
      Storage.set('guestMode', true);
      Storage.set('guestStartTime', Date.now());
      addLog('âœ… å·²è®¾ç½®ä¸ºæ¸¸å®¢æ¨¡å¼', 'success');
      updateStatus();
    }

    // æ¸…é™¤æ‰€æœ‰çŠ¶æ€
    function clearAll() {
      Storage.remove('currentUser');
      Storage.remove('guestMode');
      Storage.remove('guestStartTime');
      Storage.remove('returnUrl');
      Storage.remove('returnAction');
      addLog('ğŸ—‘ï¸ å·²æ¸…é™¤æ‰€æœ‰çŠ¶æ€', 'info');
      updateStatus();
    }

    // æŸ¥çœ‹å­˜å‚¨
    function viewStorage() {
      addLog('ğŸ“¦ å½“å‰å­˜å‚¨æ•°æ®ï¼š', 'info');
      
      const keys = ['currentUser', 'guestMode', 'returnUrl', 'returnAction', 'guestStartTime'];
      keys.forEach(key => {
        const value = Storage.get(key);
        if (value !== null) {
          addLog(`  ${key}: ${typeof value === 'object' ? JSON.stringify(value) : value}`, 'info');
        }
      });
    }

    // å‰å¾€å¼•å¯¼é¡µ
    function goToGuide() {
      addLog('ğŸš€ è·³è½¬åˆ°æ‹ç…§å¼•å¯¼é¡µ...', 'success');
      setTimeout(() => {
        window.location.href = '/web/pages/assessment/guide.html';
      }, 500);
    }

    // é¡µé¢åŠ è½½æ—¶æ›´æ–°çŠ¶æ€
    document.addEventListener('DOMContentLoaded', function() {
      updateStatus();
      addLog('ğŸ¯ æµ‹è¯•å·¥å…·å·²åŠ è½½', 'success');
      addLog('ğŸ’¡ æç¤ºï¼šä¿®æ”¹çŠ¶æ€åï¼Œç‚¹å‡»"å‰å¾€å¼•å¯¼é¡µ"æµ‹è¯•æ•ˆæœ', 'info');
    });

    // é”®ç›˜å¿«æ·é”®
    document.addEventListener('keydown', function(e) {
      // Ctrl/Cmd + L: æ¨¡æ‹Ÿç™»å½•
      if ((e.ctrlKey || e.metaKey) && e.key === 'l') {
        e.preventDefault();
        simulateLogin();
        addLog('âŒ¨ï¸ ä½¿ç”¨å¿«æ·é”®ç™»å½•', 'info');
      }
      
      // Ctrl/Cmd + G: æ¸¸å®¢æ¨¡å¼
      if ((e.ctrlKey || e.metaKey) && e.key === 'g') {
        e.preventDefault();
        simulateGuest();
        addLog('âŒ¨ï¸ ä½¿ç”¨å¿«æ·é”®åˆ‡æ¢æ¸¸å®¢æ¨¡å¼', 'info');
      }
      
      // Ctrl/Cmd + K: æ¸…é™¤çŠ¶æ€
      if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
        e.preventDefault();
        clearAll();
        addLog('âŒ¨ï¸ ä½¿ç”¨å¿«æ·é”®æ¸…é™¤çŠ¶æ€', 'info');
      }
      
      // Enter: å‰å¾€å¼•å¯¼é¡µ
      if (e.key === 'Enter' && e.target === document.body) {
        goToGuide();
      }
    });

    // å®šæœŸåˆ·æ–°çŠ¶æ€ï¼ˆæ¯2ç§’ï¼‰
    setInterval(updateStatus, 2000);
  </script>
</body>
</html>

