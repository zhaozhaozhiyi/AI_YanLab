<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ‹ç…§å¼•å¯¼ - AIé¢œå€¼ç®¡å®¶</title>
  
  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  
  <!-- è·¯å¾„é…ç½® -->
  <script>
    // å†…è”è·¯å¾„é…ç½® - æ”¯æŒæœ¬åœ°å’Œ GitHub Pages ç¯å¢ƒ
    window.PathHelper = {
      getBasePath() {
        const hostname = window.location.hostname;
        const pathname = window.location.pathname;
        if (hostname.includes('github.io')) {
          const pathParts = pathname.split('/').filter(p => p);
          if (pathParts.length > 0 && pathParts[0] !== 'web' && pathParts[0] !== 'admin') {
            return '/' + pathParts[0];
          }
        }
        if (hostname.includes('gitee.io')) {
          const pathParts = pathname.split('/').filter(p => p);
          if (pathParts.length > 0 && pathParts[0] !== 'web' && pathParts[0] !== 'admin') {
            return '/' + pathParts[0];
          }
        }
        return '';
      },
      getPath(path) {
        if (!path) return '';
        if (!path.startsWith('/')) path = '/' + path;
        let currentPath = window.location.pathname;
        const basePath = this.getBasePath();
        if (basePath && currentPath.startsWith(basePath)) {
          currentPath = currentPath.substring(basePath.length);
        }
        const currentParts = currentPath.split('/').filter(p => p);
        const currentDirs = currentParts.slice(0, -1);
        const currentDepth = currentDirs.length;
        const targetPath = path.substring(1);
        let relativePath = currentDepth === 0 ? './' : '../'.repeat(currentDepth);
        return relativePath + targetPath;
      }
    };
    
    // ç«‹å³è®¾ç½® base.css è·¯å¾„ï¼ˆé¿å…é¡µé¢é—ªçƒï¼‰
    document.write('<link rel="stylesheet" href="' + PathHelper.getPath('/web/assets/css/base.css') + '">');
  </script>
  
  <style>
    body {
      background: linear-gradient(135deg, #fef3f5 0%, #fef7fb 50%, #f5f7fe 100%);
      min-height: 100vh;
    }

    .guide-card {
      background: white;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(236, 72, 153, 0.1);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .guide-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 50px rgba(236, 72, 153, 0.15);
    }

    .angle-card {
      background: linear-gradient(135deg, #ffffff 0%, #fef7fb 100%);
      border: 2px solid #fce7f3;
      border-radius: 16px;
      padding: 1.5rem;
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .angle-card:hover {
      border-color: #ec4899;
      transform: scale(1.05);
      box-shadow: 0 8px 25px rgba(236, 72, 153, 0.2);
    }

    .angle-icon {
      width: 80px;
      height: 80px;
      margin: 0 auto 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%);
      border-radius: 50%;
      color: white;
      font-size: 2rem;
    }

    .tip-item {
      background: #fef7fb;
      border-left: 4px solid #ec4899;
      padding: 1rem 1.5rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      transition: all 0.3s ease;
    }

    .tip-item:hover {
      background: #fce7f3;
      transform: translateX(5px);
    }

    .start-button {
      background: linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%);
      color: white;
      padding: 1rem 3rem;
      border-radius: 50px;
      font-size: 1.125rem;
      font-weight: 600;
      border: none;
      cursor: pointer;
      box-shadow: 0 10px 30px rgba(236, 72, 153, 0.3);
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .start-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 15px 40px rgba(236, 72, 153, 0.4);
    }

    .start-button:active {
      transform: translateY(0);
    }

    .header-gradient {
      background: linear-gradient(135deg, #ec4899 0%, #8b5cf6 50%, #6366f1 100%);
      color: white;
      padding: 2rem 1rem;
      border-radius: 0 0 30px 30px;
    }

    .badge {
      display: inline-block;
      background: rgba(255, 255, 255, 0.2);
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.875rem;
      margin-bottom: 0.5rem;
    }

    @keyframes pulse {
      0%, 100% {
        opacity: 1;
      }
      50% {
        opacity: 0.5;
      }
    }

    .pulse-animate {
      animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
    }

    /* æ¨¡æ€æ¡†æ ·å¼ */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .modal-overlay.show {
      opacity: 1;
    }

    .modal-content {
      background: white;
      border-radius: 24px;
      padding: 2rem;
      max-width: 420px;
      width: 90%;
      margin: 1rem;
      position: relative;
      transform: scale(0.9);
      transition: transform 0.3s ease;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .modal-overlay.show .modal-content {
      transform: scale(1);
    }

    .modal-icon-wrapper {
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, #fce7f3 0%, #f3e8ff 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 1.5rem;
    }

    .modal-icon {
      font-size: 2.5rem;
      background: linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .modal-close {
      position: absolute;
      top: 1rem;
      right: 1rem;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: #f3f4f6;
      border: none;
      color: #6b7280;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }

    .modal-close:hover {
      background: #e5e7eb;
      color: #374151;
    }

    .btn-primary {
      width: 100%;
      padding: 1rem;
      background: linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%);
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
      box-shadow: 0 4px 15px rgba(236, 72, 153, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(236, 72, 153, 0.4);
    }

    .btn-secondary {
      width: 100%;
      padding: 1rem;
      background: white;
      color: #6b7280;
      border: 2px solid #e5e7eb;
      border-radius: 12px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.5rem;
    }

    .btn-secondary:hover {
      border-color: #ec4899;
      color: #ec4899;
      transform: translateY(-2px);
    }

    .benefit-tag {
      display: inline-flex;
      align-items: center;
      gap: 0.25rem;
      background: #fef3f5;
      color: #ec4899;
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.75rem;
      font-weight: 500;
    }
  </style>
</head>
<body>
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <div class="header-gradient">
    <div class="max-w-4xl mx-auto">
      <button onclick="Router.back()" class="text-white mb-4 flex items-center gap-2 hover:opacity-80 transition-opacity">
        <i class="fas fa-arrow-left"></i>
        <span>è¿”å›</span>
      </button>
      <div class="text-center">
        <div class="badge">
          <i class="fas fa-crown mr-1"></i>
          ä¸“ä¸šAIè¯„ä¼°
        </div>
        <h1 class="text-3xl font-bold mb-2">å…è´¹é¢œå€¼è¯„ä¼°</h1>
        <p class="text-white/90">ä»…éœ€30ç§’ï¼Œè·å–ä¸“ä¸šé¢éƒ¨åˆ†ææŠ¥å‘Š</p>
      </div>
    </div>
  </div>

  <!-- ä¸»è¦å†…å®¹ -->
  <div class="max-w-4xl mx-auto px-4 py-8">
    <!-- æ‹ç…§è§’åº¦è¯´æ˜ -->
    <div class="guide-card p-8 mb-6">
      <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">
        <i class="fas fa-camera text-pink-500 mr-2"></i>
        æ‹ç…§è§’åº¦è¯´æ˜
      </h2>
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        <!-- æ­£é¢ç…§ -->
        <div class="angle-card text-center">
          <div class="angle-icon">
            <i class="fas fa-user"></i>
          </div>
          <h3 class="text-lg font-semibold text-gray-800 mb-2">æ­£é¢ç…§</h3>
          <p class="text-gray-600 text-sm mb-3">é¢éƒ¨å®Œæ•´ï¼Œæ­£å¯¹é•œå¤´</p>
          <div class="flex items-center justify-center text-pink-500 text-sm">
            <i class="fas fa-check-circle mr-1"></i>
            <span>å¿…æ‹</span>
          </div>
        </div>

        <!-- å·¦ä¾§45åº¦ -->
        <div class="angle-card text-center">
          <div class="angle-icon">
            <i class="fas fa-user-slash" style="transform: rotate(-45deg);"></i>
          </div>
          <h3 class="text-lg font-semibold text-gray-800 mb-2">å·¦ä¾§45Â°</h3>
          <p class="text-gray-600 text-sm mb-3">è½»å¾®è½¬å‘å·¦ä¾§</p>
          <div class="flex items-center justify-center text-pink-500 text-sm">
            <i class="fas fa-check-circle mr-1"></i>
            <span>å¿…æ‹</span>
          </div>
        </div>

        <!-- å³ä¾§45åº¦ -->
        <div class="angle-card text-center">
          <div class="angle-icon">
            <i class="fas fa-user-slash" style="transform: rotate(45deg);"></i>
          </div>
          <h3 class="text-lg font-semibold text-gray-800 mb-2">å³ä¾§45Â°</h3>
          <p class="text-gray-600 text-sm mb-3">è½»å¾®è½¬å‘å³ä¾§</p>
          <div class="flex items-center justify-center text-pink-500 text-sm">
            <i class="fas fa-check-circle mr-1"></i>
            <span>å¿…æ‹</span>
          </div>
        </div>
      </div>
    </div>

    <!-- æ‹ç…§å°è´´å£« -->
    <div class="guide-card p-8 mb-6">
      <h2 class="text-2xl font-bold text-gray-800 mb-6">
        <i class="fas fa-lightbulb text-yellow-500 mr-2"></i>
        æ‹ç…§å°è´´å£«
      </h2>
      
      <div class="space-y-4">
        <div class="tip-item">
          <div class="flex items-start">
            <div class="flex-shrink-0 w-8 h-8 bg-pink-500 text-white rounded-full flex items-center justify-center mr-3">
              <i class="fas fa-sun"></i>
            </div>
            <div>
              <h3 class="font-semibold text-gray-800 mb-1">å…‰çº¿å……è¶³</h3>
              <p class="text-gray-600 text-sm">åœ¨å…‰çº¿æ˜äº®çš„ç¯å¢ƒä¸‹æ‹æ‘„ï¼Œé¿å…èƒŒå…‰å’Œå¼ºå…‰ç›´å°„</p>
            </div>
          </div>
        </div>

        <div class="tip-item">
          <div class="flex items-start">
            <div class="flex-shrink-0 w-8 h-8 bg-purple-500 text-white rounded-full flex items-center justify-center mr-3">
              <i class="fas fa-smile"></i>
            </div>
            <div>
              <h3 class="font-semibold text-gray-800 mb-1">é¢éƒ¨æ”¾æ¾</h3>
              <p class="text-gray-600 text-sm">ä¿æŒè‡ªç„¶è¡¨æƒ…ï¼Œé¢éƒ¨æ”¾æ¾ï¼Œä¸è¦åˆ»æ„åšè¡¨æƒ…</p>
            </div>
          </div>
        </div>

        <div class="tip-item">
          <div class="flex items-start">
            <div class="flex-shrink-0 w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center mr-3">
              <i class="fas fa-eye"></i>
            </div>
            <div>
              <h3 class="font-semibold text-gray-800 mb-1">äº”å®˜æ¸…æ™°</h3>
              <p class="text-gray-600 text-sm">ç¡®ä¿é¢éƒ¨äº”å®˜æ¸…æ™°å¯è§ï¼Œä¸è¦è¢«å¤´å‘é®æŒ¡</p>
            </div>
          </div>
        </div>

        <div class="tip-item">
          <div class="flex items-start">
            <div class="flex-shrink-0 w-8 h-8 bg-green-500 text-white rounded-full flex items-center justify-center mr-3">
              <i class="fas fa-ban"></i>
            </div>
            <div>
              <h3 class="font-semibold text-gray-800 mb-1">é¿å…é®æŒ¡</h3>
              <p class="text-gray-600 text-sm">æ‹æ‘„æ—¶æ‘˜æ‰çœ¼é•œã€å£ç½©ç­‰é®æŒ¡ç‰©ï¼Œéœ²å‡ºå®Œæ•´é¢éƒ¨</p>
            </div>
          </div>
        </div>

        <div class="tip-item">
          <div class="flex items-start">
            <div class="flex-shrink-0 w-8 h-8 bg-orange-500 text-white rounded-full flex items-center justify-center mr-3">
              <i class="fas fa-shield-alt"></i>
            </div>
            <div>
              <h3 class="font-semibold text-gray-800 mb-1">éšç§ä¿æŠ¤</h3>
              <p class="text-gray-600 text-sm">æ‚¨çš„ç…§ç‰‡ä»…ç”¨äºAIåˆ†æï¼Œæˆ‘ä»¬æ‰¿è¯ºä¸¥æ ¼ä¿æŠ¤æ‚¨çš„éšç§</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- è¯„ä¼°ä¼˜åŠ¿è¯´æ˜ -->
    <div class="guide-card p-8 mb-8">
      <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">
        <i class="fas fa-star text-yellow-500 mr-2"></i>
        ä¸ºä»€ä¹ˆé€‰æ‹©æˆ‘ä»¬
      </h2>
      
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
        <div class="text-center">
          <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-pink-500 to-purple-500 rounded-full flex items-center justify-center text-white text-2xl">
            <i class="fas fa-brain"></i>
          </div>
          <h3 class="font-semibold text-gray-800 mb-2">AIæ™ºèƒ½åˆ†æ</h3>
          <p class="text-gray-600 text-sm">é‡‡ç”¨å…ˆè¿›AIæŠ€æœ¯ï¼Œç²¾å‡†è¯†åˆ«é¢éƒ¨é—®é¢˜</p>
        </div>

        <div class="text-center">
          <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center text-white text-2xl">
            <i class="fas fa-user-md"></i>
          </div>
          <h3 class="font-semibold text-gray-800 mb-2">ä¸“å®¶çº§æŠ¥å‘Š</h3>
          <p class="text-gray-600 text-sm">ä¸“ä¸šåŒ»ç¾ä¸“å®¶å›¢é˜Ÿæä¾›æƒå¨å»ºè®®</p>
        </div>

        <div class="text-center">
          <div class="w-16 h-16 mx-auto mb-4 bg-gradient-to-r from-blue-500 to-green-500 rounded-full flex items-center justify-center text-white text-2xl">
            <i class="fas fa-lock"></i>
          </div>
          <h3 class="font-semibold text-gray-800 mb-2">éšç§ä¿æŠ¤</h3>
          <p class="text-gray-600 text-sm">æ•°æ®åŠ å¯†å­˜å‚¨ï¼Œç»ä¸æ³„éœ²ä¸ªäººä¿¡æ¯</p>
        </div>
      </div>
    </div>

    <!-- å¼€å§‹æ‹ç…§æŒ‰é’® -->
    <div class="text-center mb-8">
      <button onclick="startCamera()" class="start-button mx-auto">
        <i class="fas fa-camera"></i>
        <span>å¼€å§‹æ‹ç…§</span>
      </button>
      <p class="text-gray-500 text-sm mt-4">
        <i class="fas fa-clock mr-1 pulse-animate"></i>
        é¢„è®¡è¯„ä¼°æ—¶é—´ï¼š30-60ç§’
      </p>
    </div>
  </div>

  <!-- å¼•å…¥å…±äº«è„šæœ¬ - ä½¿ç”¨ç›¸å¯¹è·¯å¾„å…¼å®¹ GitHub Pages -->
  <script src="../../../shared/storage.js"></script>
  <script src="../../../shared/utils.js"></script>
  <script src="../../../shared/router.js"></script>

  <script>
    // ==================== æ ¸å¿ƒåŠŸèƒ½ ====================
    
    // å¼€å§‹æ‹ç…§
    function startCamera() {
      // è°ƒè¯•ï¼šæ£€æŸ¥ Storage æ˜¯å¦åŠ è½½
      if (typeof Storage === 'undefined') {
        console.error('âŒ Storage æœªåŠ è½½ï¼æ£€æŸ¥ storage.js è·¯å¾„:', '../../../shared/storage.js');
        alert('é¡µé¢èµ„æºåŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
        return;
      }
      
      console.log('âœ… Storage å·²åŠ è½½ï¼Œå¼€å§‹æ£€æŸ¥ç™»å½•çŠ¶æ€...');
      const currentUser = Storage.get('currentUser');
      
      if (!currentUser) {
        // æœªç™»å½•ï¼šæ˜¾ç¤ºå‹å¥½çš„ç™»å½•æç¤º
        console.log('æœªç™»å½•ï¼Œæ˜¾ç¤ºç™»å½•æç¤º');
        showLoginPrompt();
      } else {
        // å·²ç™»å½•ï¼šç›´æ¥è¿›å…¥æ‹ç…§
        console.log('å·²ç™»å½•ï¼Œç›´æ¥è¿›å…¥æ‹ç…§é¡µé¢');
        navigateToCamera();
      }
    }

    // æ˜¾ç¤ºç™»å½•æç¤ºæ¨¡æ€æ¡†
    function showLoginPrompt() {
      const modalHTML = `
        <div id="loginModal" class="modal-overlay">
          <div class="modal-content">
            <!-- å…³é—­æŒ‰é’® -->
            <button class="modal-close" onclick="closeLoginModal()">
              <i class="fas fa-times"></i>
            </button>

            <!-- å›¾æ ‡ -->
            <div class="modal-icon-wrapper">
              <i class="fas fa-user-circle modal-icon"></i>
            </div>

            <!-- æ ‡é¢˜å’Œæè¿° -->
            <div class="text-center mb-6">
              <h3 class="text-2xl font-bold text-gray-800 mb-3">å¼€å§‹é¢œå€¼è¯„ä¼°</h3>
              <p class="text-gray-600 text-sm leading-relaxed mb-4">
                ç™»å½•åå¯äº«å—å®Œæ•´æœåŠ¡ä½“éªŒ
              </p>
              
              <!-- ç™»å½•ä¼˜åŠ¿æ ‡ç­¾ -->
              <div class="flex flex-wrap gap-2 justify-center">
                <span class="benefit-tag">
                  <i class="fas fa-save"></i>
                  ä¿å­˜æŠ¥å‘Š
                </span>
                <span class="benefit-tag">
                  <i class="fas fa-history"></i>
                  æŸ¥çœ‹å†å²
                </span>
                <span class="benefit-tag">
                  <i class="fas fa-chart-line"></i>
                  è¿½è¸ªå˜åŒ–
                </span>
              </div>
            </div>

            <!-- æŒ‰é’®ç»„ -->
            <div class="space-y-3">
              <!-- ç™»å½•æŒ‰é’® -->
              <button onclick="goToLogin()" class="btn-primary">
                <i class="fas fa-sign-in-alt"></i>
                <span>ç™»å½•/æ³¨å†Œ</span>
              </button>

              <!-- æ¸¸å®¢ä½“éªŒæŒ‰é’® -->
              <button onclick="continueAsGuest()" class="btn-secondary">
                <i class="fas fa-eye"></i>
                <span>æ¸¸å®¢ä½“éªŒï¼ˆæŠ¥å‘Šä¸ä¿å­˜ï¼‰</span>
              </button>
            </div>

            <!-- åº•éƒ¨æç¤º -->
            <div class="mt-4 text-center">
              <p class="text-xs text-gray-400">
                <i class="fas fa-shield-alt mr-1"></i>
                æ‚¨çš„éšç§å®‰å…¨å—åˆ°ä¸¥æ ¼ä¿æŠ¤
              </p>
            </div>
          </div>
        </div>
      `;

      // æ’å…¥æ¨¡æ€æ¡†
      document.body.insertAdjacentHTML('beforeend', modalHTML);
      
      // è§¦å‘åŠ¨ç”»
      setTimeout(() => {
        const modal = document.getElementById('loginModal');
        if (modal) {
          modal.classList.add('show');
        }
      }, 10);

      // é˜»æ­¢èƒŒæ™¯æ»šåŠ¨
      document.body.style.overflow = 'hidden';
    }

    // å…³é—­ç™»å½•æ¨¡æ€æ¡†
    function closeLoginModal() {
      const modal = document.getElementById('loginModal');
      if (modal) {
        modal.classList.remove('show');
        setTimeout(() => {
          modal.remove();
          // æ¢å¤èƒŒæ™¯æ»šåŠ¨
          document.body.style.overflow = '';
        }, 300);
      }
    }

    // è·³è½¬åˆ°ç™»å½•é¡µ
    function goToLogin() {
      // ä¿å­˜è¿”å›è·¯å¾„ï¼Œç™»å½•æˆåŠŸåè‡ªåŠ¨è¿”å›
      Storage.set('returnUrl', '/web/pages/assessment/guide.html');
      Storage.set('returnAction', 'startCamera'); // æ ‡è®°è¿”å›åçš„æ“ä½œ
      
      // è·³è½¬åˆ°ç™»å½•é¡µï¼ˆä½¿ç”¨ç»å¯¹è·¯å¾„ï¼‰
      Router.navigate('/web/pages/auth/login.html');
    }

    // æ¸¸å®¢ç»§ç»­ä½“éªŒ
    function continueAsGuest() {
      console.log('ç”¨æˆ·é€‰æ‹©æ¸¸å®¢æ¨¡å¼ä½“éªŒ');
      
      // è®¾ç½®æ¸¸å®¢æ¨¡å¼æ ‡è®°
      Storage.set('guestMode', true);
      Storage.set('guestStartTime', Date.now());
      
      // å…³é—­æ¨¡æ€æ¡†
      closeLoginModal();
      
      // çŸ­æš‚å»¶è¿Ÿåè·³è½¬ï¼Œè®©ç”¨æˆ·çœ‹åˆ°å…³é—­åŠ¨ç”»
      setTimeout(() => {
        navigateToCamera();
      }, 300);
    }

    // è·³è½¬åˆ°æ‹ç…§é¡µé¢
    function navigateToCamera() {
      const currentUser = Storage.get('currentUser');
      const isGuest = Storage.get('guestMode');
      
      console.log('å¯¼èˆªåˆ°æ‹ç…§é¡µé¢:', {
        isLoggedIn: !!currentUser,
        isGuest: isGuest
      });
      
      // ä½¿ç”¨ç»å¯¹è·¯å¾„å¯¼èˆª
      Router.navigate('/web/pages/assessment/camera.html');
    }

    // ==================== é¡µé¢åŠ è½½å’Œåˆå§‹åŒ– ====================
    
    document.addEventListener('DOMContentLoaded', function() {
      console.log('ğŸ“„ æ‹ç…§å¼•å¯¼é¡µå·²åŠ è½½');
      
      // æ£€æŸ¥ä¾èµ–æ˜¯å¦åŠ è½½
      console.log('ğŸ” æ£€æŸ¥ä¾èµ–åŠ è½½çŠ¶æ€:');
      console.log('  - Storage:', typeof Storage !== 'undefined' ? 'âœ…' : 'âŒ');
      console.log('  - Router:', typeof Router !== 'undefined' ? 'âœ…' : 'âŒ');
      console.log('  - PathHelper:', typeof PathHelper !== 'undefined' ? 'âœ…' : 'âŒ');
      
      if (typeof Storage === 'undefined') {
        console.error('âŒ Storage æœªåŠ è½½ï¼Œè¯·æ£€æŸ¥ storage.js æ–‡ä»¶è·¯å¾„');
      }
      if (typeof Router === 'undefined') {
        console.error('âŒ Router æœªåŠ è½½ï¼Œè¯·æ£€æŸ¥ router.js æ–‡ä»¶è·¯å¾„');
      }
      
      // æ£€æŸ¥æ˜¯å¦æ˜¯ç™»å½•åè¿”å›
      checkLoginReturn();
      
      // æ·»åŠ æ·¡å…¥åŠ¨ç”»
      animateCards();
      
      // ç‚¹å‡»æ¨¡æ€æ¡†èƒŒæ™¯å…³é—­
      document.addEventListener('click', function(e) {
        if (e.target && e.target.id === 'loginModal') {
          closeLoginModal();
        }
      });
      
      // ESCé”®å…³é—­æ¨¡æ€æ¡†
      document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
          closeLoginModal();
        }
      });
    });

    // æ£€æŸ¥ç™»å½•è¿”å›
    function checkLoginReturn() {
      const returnAction = Storage.get('returnAction');
      const currentUser = Storage.get('currentUser');
      
      if (returnAction === 'startCamera' && currentUser) {
        console.log('æ£€æµ‹åˆ°ç™»å½•è¿”å›ï¼Œè‡ªåŠ¨è·³è½¬æ‹ç…§é¡µé¢');
        
        // æ¸…é™¤è¿”å›æ ‡è®°
        Storage.remove('returnAction');
        Storage.remove('returnUrl');
        
        // æ˜¾ç¤ºæ¬¢è¿æç¤º
        showWelcomeToast();
        
        // è‡ªåŠ¨è·³è½¬åˆ°æ‹ç…§é¡µé¢
        setTimeout(() => {
          navigateToCamera();
        }, 1500);
      }
    }

    // æ˜¾ç¤ºæ¬¢è¿æç¤º
    function showWelcomeToast() {
      const currentUser = Storage.get('currentUser');
      const userName = currentUser.nickname || currentUser.phone || 'ç”¨æˆ·';
      
      const toast = document.createElement('div');
      toast.style.cssText = `
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: linear-gradient(135deg, #ec4899 0%, #8b5cf6 100%);
        color: white;
        padding: 1rem 2rem;
        border-radius: 50px;
        box-shadow: 0 10px 30px rgba(236, 72, 153, 0.3);
        z-index: 10000;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 0.5rem;
        animation: slideDown 0.5s ease;
      `;
      toast.innerHTML = `
        <i class="fas fa-check-circle"></i>
        <span>æ¬¢è¿å›æ¥ï¼Œ${userName}ï¼</span>
      `;
      
      document.body.appendChild(toast);
      
      setTimeout(() => {
        toast.style.animation = 'slideUp 0.5s ease';
        setTimeout(() => toast.remove(), 500);
      }, 1500);
    }

    // å¡ç‰‡æ·¡å…¥åŠ¨ç”»
    function animateCards() {
      const cards = document.querySelectorAll('.guide-card');
      cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
        
        setTimeout(() => {
          card.style.opacity = '1';
          card.style.transform = 'translateY(0)';
        }, index * 100 + 100);
      });
    }

    // ==================== è°ƒè¯•å·¥å…·ï¼ˆå¼€å‘æ—¶ä½¿ç”¨ï¼‰====================
    
    // æ¨¡æ‹Ÿç™»å½•çŠ¶æ€ï¼ˆç”¨äºæµ‹è¯•ï¼‰
    window.debugLogin = function(userInfo = null) {
      const testUser = userInfo || {
        id: 'test_' + Date.now(),
        phone: '13800138000',
        nickname: 'æµ‹è¯•ç”¨æˆ·',
        avatar: '/web/assets/images/avatars/avatar1.jpg',
        loginTime: Date.now()
      };
      
      Storage.set('currentUser', testUser);
      console.log('âœ… å·²è®¾ç½®æµ‹è¯•ç™»å½•çŠ¶æ€:', testUser);
      location.reload();
    };

    // æ¸…é™¤ç™»å½•çŠ¶æ€ï¼ˆç”¨äºæµ‹è¯•ï¼‰
    window.debugLogout = function() {
      Storage.remove('currentUser');
      Storage.remove('guestMode');
      Storage.remove('returnAction');
      Storage.remove('returnUrl');
      console.log('âœ… å·²æ¸…é™¤æ‰€æœ‰ç™»å½•çŠ¶æ€');
      location.reload();
    };

    // æŸ¥çœ‹å½“å‰çŠ¶æ€
    window.debugStatus = function() {
      const currentUser = Storage.get('currentUser');
      const isGuest = Storage.get('guestMode');
      const returnAction = Storage.get('returnAction');
      
      console.log('=== å½“å‰çŠ¶æ€ ===');
      console.log('ç™»å½•çŠ¶æ€:', currentUser ? 'å·²ç™»å½•' : 'æœªç™»å½•');
      console.log('ç”¨æˆ·ä¿¡æ¯:', currentUser);
      console.log('æ¸¸å®¢æ¨¡å¼:', isGuest ? 'æ˜¯' : 'å¦');
      console.log('è¿”å›åŠ¨ä½œ:', returnAction);
      console.log('================');
    };

    console.log('ğŸ’¡ è°ƒè¯•æç¤ºï¼š');
    console.log('  - debugLogin()   : æ¨¡æ‹Ÿç™»å½•');
    console.log('  - debugLogout()  : æ¸…é™¤ç™»å½•');
    console.log('  - debugStatus()  : æŸ¥çœ‹çŠ¶æ€');
  </script>

  <!-- åŠ¨ç”»æ ·å¼ -->
  <style>
    @keyframes slideDown {
      from {
        transform: translate(-50%, -100%);
        opacity: 0;
      }
      to {
        transform: translate(-50%, 0);
        opacity: 1;
      }
    }

    @keyframes slideUp {
      from {
        transform: translate(-50%, 0);
        opacity: 1;
      }
      to {
        transform: translate(-50%, -100%);
        opacity: 0;
      }
    }
  </style>
</body>
</html>


