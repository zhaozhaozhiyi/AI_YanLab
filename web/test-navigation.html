<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¯¼èˆªåŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            line-height: 1.6;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .success { background: #d4edda; border-color: #c3e6cb; }
        .error { background: #f8d7da; border-color: #f5c6cb; }
        .info { background: #d1ecf1; border-color: #bee5eb; }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #0056b3; }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
            font-size: 12px;
        }
        .nav-test {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        .nav-button {
            background: #28a745;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s;
        }
        .nav-button:hover { background: #218838; }
        .nav-button:disabled { background: #6c757d; cursor: not-allowed; }
    </style>
</head>
<body>
    <h1>ğŸ§­ å¯¼èˆªåŠŸèƒ½æµ‹è¯•</h1>
    
    <div class="test-section info">
        <h3>ğŸ“‹ æµ‹è¯•è¯´æ˜</h3>
        <p>è¿™ä¸ªé¡µé¢ç”¨äºæµ‹è¯•å¯¼èˆªåŠŸèƒ½åœ¨GitHub Pagesç¯å¢ƒä¸‹çš„å·¥ä½œçŠ¶æ€ã€‚ç‚¹å‡»ä¸‹é¢çš„å¯¼èˆªæŒ‰é’®æµ‹è¯•é¡µé¢è·³è½¬åŠŸèƒ½ã€‚</p>
    </div>

    <div class="test-section">
        <h3>ğŸ“ å½“å‰ç¯å¢ƒä¿¡æ¯</h3>
        <div id="envInfo">æ£€æµ‹ä¸­...</div>
    </div>

    <div class="test-section">
        <h3>ğŸ§­ å¯¼èˆªæµ‹è¯•</h3>
        <div class="nav-test">
            <button class="nav-button" onclick="testNavigation('home')">é¦–é¡µ</button>
            <button class="nav-button" onclick="testNavigation('assessment')">è¯„ä¼°</button>
            <button class="nav-button" onclick="testNavigation('community')">ç¤¾åŒº</button>
            <button class="nav-button" onclick="testNavigation('profile')">æˆ‘çš„</button>
        </div>
        <p><strong>æ³¨æ„ï¼š</strong>ç‚¹å‡»æŒ‰é’®ä¼šå°è¯•è·³è½¬ï¼Œå¦‚æœè·³è½¬å¤±è´¥ä¼šåœ¨æ—¥å¿—ä¸­æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯ã€‚</p>
    </div>

    <div class="test-section">
        <h3>ğŸ“ å¯¼èˆªæ—¥å¿—</h3>
        <div id="navLog" class="log">å¯¼èˆªæ—¥å¿—å°†æ˜¾ç¤ºåœ¨è¿™é‡Œ...\n</div>
        <button onclick="clearLog()">æ¸…ç©ºæ—¥å¿—</button>
    </div>

    <script>
        // å†…è”è·¯å¾„é…ç½®
        window.PathConfig = {
            getBasePath() {
                const hostname = window.location.hostname;
                const pathname = window.location.pathname;
                
                if (hostname.includes('github.io')) {
                    const pathParts = pathname.split('/').filter(p => p);
                    if (pathParts.length > 0) {
                        return '/' + pathParts[0];
                    }
                }
                return '';
            },
            
            getAssetPath(relativePath) {
                if (!relativePath) return '';
                if (!relativePath.startsWith('/')) {
                    relativePath = '/' + relativePath;
                }
                return this.getBasePath() + relativePath;
            },
            
            getPagePath(absolutePath) {
                if (!absolutePath) return '';
                
                // å¦‚æœå·²ç»æ˜¯ç›¸å¯¹è·¯å¾„ï¼Œç›´æ¥è¿”å›
                if (!absolutePath.startsWith('/')) {
                    return absolutePath;
                }
                
                // è·å–å½“å‰é¡µé¢çš„è·¯å¾„
                const currentPath = window.location.pathname;
                const currentParts = currentPath.split('/').filter(p => p);
                
                // å»æ‰æ–‡ä»¶åï¼Œåªä¿ç•™ç›®å½•éƒ¨åˆ†
                const currentDirs = currentParts.slice(0, -1);
                const currentDepth = currentDirs.length;
                
                // æ„å»ºç›¸å¯¹è·¯å¾„ï¼šæ ¹æ®æ·±åº¦æ·»åŠ  ../
                let relativePath = '';
                if (currentDepth === 0) {
                    relativePath = './';
                } else {
                    relativePath = '../'.repeat(currentDepth);
                }
                
                // ç›®æ ‡è·¯å¾„ï¼ˆå»æ‰å¼€å¤´çš„ /ï¼‰
                const targetPath = absolutePath.substring(1);
                
                return relativePath + targetPath;
            }
        };

        let logElement = document.getElementById('navLog');
        
        function log(message) {
            const timestamp = new Date().toLocaleTimeString();
            const logMessage = `[${timestamp}] ${message}\n`;
            logElement.textContent += logMessage;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(message);
        }

        function clearLog() {
            logElement.textContent = 'æ—¥å¿—å·²æ¸…ç©º\n';
        }

        function testNavigation(type) {
            log(`ğŸ§­ æµ‹è¯•å¯¼èˆª: ${type}`);
            
            let targetPath = '';
            let expectedUrl = '';
            
            switch(type) {
                case 'home':
                    targetPath = PathConfig.getPagePath('/web/index.html');
                    expectedUrl = '/web/index.html';
                    break;
                case 'assessment':
                    targetPath = PathConfig.getPagePath('/web/pages/assessment/index.html');
                    expectedUrl = '/web/pages/assessment/index.html';
                    break;
                case 'community':
                    targetPath = PathConfig.getPagePath('/web/pages/community/index.html');
                    expectedUrl = '/web/pages/community/index.html';
                    break;
                case 'profile':
                    targetPath = PathConfig.getPagePath('/web/pages/profile/index.html');
                    expectedUrl = '/web/pages/profile/index.html';
                    break;
                default:
                    log(`âŒ æœªçŸ¥çš„å¯¼èˆªç±»å‹: ${type}`);
                    return;
            }
            
            log(`ğŸ“ ç›®æ ‡è·¯å¾„: ${targetPath}`);
            log(`ğŸ”— æœŸæœ›URL: ${expectedUrl}`);
            
            // æµ‹è¯•è·¯å¾„ç”Ÿæˆ
            if (targetPath) {
                log(`âœ… è·¯å¾„ç”ŸæˆæˆåŠŸ: ${targetPath}`);
                
                // æ˜¾ç¤ºå®é™…è·³è½¬ï¼ˆæ³¨é‡Šæ‰ä»¥é¿å…å®é™…è·³è½¬ï¼‰
                // window.location.href = targetPath;
                log(`ğŸš€ å‡†å¤‡è·³è½¬åˆ°: ${targetPath}`);
                log(`ğŸ’¡ æç¤º: å®é™…ç¯å¢ƒä¸­ä¼šæ‰§è¡Œè·³è½¬`);
                
            } else {
                log(`âŒ è·¯å¾„ç”Ÿæˆå¤±è´¥`);
            }
        }

        // ç¯å¢ƒæ£€æµ‹
        function detectEnvironment() {
            log('ğŸ” å¼€å§‹ç¯å¢ƒæ£€æµ‹...');
            
            const env = {
                hostname: window.location.hostname,
                pathname: window.location.pathname,
                basePath: PathConfig.getBasePath()
            };
            
            const envInfo = document.getElementById('envInfo');
            envInfo.innerHTML = `
                <p><strong>ä¸»æœºå:</strong> ${env.hostname}</p>
                <p><strong>å½“å‰è·¯å¾„:</strong> ${env.pathname}</p>
                <p><strong>åŸºç¡€è·¯å¾„:</strong> ${env.basePath || '(ç©º)'}</p>
                <p><strong>ç¯å¢ƒç±»å‹:</strong> ${env.hostname.includes('github.io') ? 'GitHub Pages' : 'æœ¬åœ°/å…¶ä»–'}</p>
            `;
            
            log(`âœ… ç¯å¢ƒæ£€æµ‹å®Œæˆ: ${env.hostname.includes('github.io') ? 'GitHub Pages' : 'æœ¬åœ°/å…¶ä»–'} ç¯å¢ƒ`);
            if (env.basePath) {
                log(`ğŸ“ åŸºç¡€è·¯å¾„: ${env.basePath}`);
            }
        }

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨æ£€æµ‹ç¯å¢ƒ
        document.addEventListener('DOMContentLoaded', function() {
            log('ğŸš€ å¯¼èˆªæµ‹è¯•é¡µé¢å·²åŠ è½½');
            detectEnvironment();
        });
    </script>
</body>
</html>
